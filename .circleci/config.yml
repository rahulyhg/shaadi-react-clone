version: 2

jobs:
  build:
    docker:
    - image: circleci/node:10.12.0-browsers
    working_directory: ~/shaadi-react/Nightwatch-Web-Testing/
    steps:
    - checkout
    - restore_cache:
        key: shaadi-react-10.12.0-v1-{{ arch }}-{{ checksum "yarn.lock" }}-{{ checksum "package.json" }}

    - run:
        command: |
                  echo ${CI_PULL_REQUEST}
                  echo ${CI}
                  echo ${CIRCLE_BRANCH}
                  echo ${CIRCLE_BUILD_URL}
                  echo ${CIRCLE_JOB}
                  echo ${CIRCLE_PR_USERNAME}
                  echo ${CIRCLE_PR_REPONAME}
                  echo ${CIRCLE_PULL_REQUEST}
                  echo ${HOME}
                  echo ${CIRCLE_REPOSITORY_URL}
                  echo ${CIRCLE_TAG}
    - run:
        name: Change folder to NW & install dep
        command: cd Nightwatch-Web-Testing && npm install  && mkdir -p Result  && cd Monetization/Batch_Execution/ && chmod +x pp1-regression.sh && xvfb-run -a ./pp1-regression.sh

workflows:
  version: 2
  workflow:
    jobs:
    - build:
        filters:
          branches:
            only: /^master/